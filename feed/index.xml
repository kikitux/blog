<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
 
 <title>kikitux.net</title>
 <link href="http://kikitux.net/atom.xml" rel="self"/>
 <link href="http://kikitux.net"/>
 <updated>2013-02-22T15:30:44+13:00</updated>
 <id>http://kikitux.net</id>
 <author>
   <name>Alvaro Miranda</name>
   <email>kikitux@gmail.com</email>
 </author>

 
 <entry>
   <title>zfs data protection</title>
   <link href="http://kikitux.net/zfs/zfs-data-protection.html"/>
   <updated>2013-02-22T00:00:00+13:00</updated>
   <id>http://kikitux.net/zfs/zfs-data-protection</id>
   <content type="html">&lt;p&gt;When ZFS for MAC came out with ZEVO, I did run to get the software and being used for about a year or so..&lt;/p&gt;

&lt;p&gt;If you stay away enabling dedup, the filesystem run very good.&lt;/p&gt;

&lt;p&gt;Today, I did format a 500gb disk to use for some VM's in my laptop. If those VM's die, it's ok, I usually have VirtualBox appliances, and backup of the software, so I could be able to start from scratch.&lt;/p&gt;

&lt;p&gt;However, I will like to protect the whole disk file without having to backup, in case I drop the hdd (again), and some blocks came corrupted.&lt;/p&gt;

&lt;p&gt;I did use the zfs option to have more copies stored on disk, in this case 2.&lt;/p&gt;

&lt;h3&gt;Disk just formatted&lt;/h3&gt;

&lt;p&gt;retina:~ mirandaa$ zfs get copies
NAME      PROPERTY  VALUE   SOURCE
zfs500gb  copies    1       local&lt;/p&gt;

&lt;h3&gt;Enable the option copy=2&lt;/h3&gt;

&lt;p&gt;retina:~ mirandaa$ zfs set copies=2 zfs500gb
retina:~ mirandaa$ zfs get copies
NAME      PROPERTY  VALUE   SOURCE
zfs500gb  copies    2       local&lt;/p&gt;

&lt;h2&gt;let's write some data&lt;/h2&gt;

&lt;h3&gt;100MB&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;retina:~ mirandaa$ df -h /Volumes/zfs500gb/
Filesystem   Size   Used  Avail Capacity iused     ifree %iused  Mounted on
/dev/disk2  457Gi  354Ki  457Gi     1%      70 957873343    0%   /Volumes/zfs500gb
retina:~ mirandaa$ dd if=/dev/zero of=/Volumes/zfs500gb/file bs=1024000 count=100
100+0 records in
100+0 records out
102400000 bytes transferred in 0.067305 secs (1521435685 bytes/sec)
retina:~ mirandaa$ df -h /Volumes/zfs500gb/
Filesystem   Size   Used  Avail Capacity iused     ifree %iused  Mounted on
/dev/disk2  457Gi  196Mi  457Gi     1%      71 957472837    0%   /Volumes/zfs500gb
retina:~ mirandaa$ ls -alh /Volumes/zfs500gb/file 
-rw-r--r--  1 mirandaa  staff    98M 22 Feb 13:31 /Volumes/zfs500gb/file
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;1GB&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;retina:~ mirandaa$ dd if=/dev/zero of=/Volumes/zfs500gb/file bs=1024000 count=1000
1000+0 records in
1000+0 records out
1024000000 bytes transferred in 32.551312 secs (31458025 bytes/sec)
retina:~ mirandaa$ df -h /Volumes/zfs500gb/
Filesystem   Size   Used  Avail Capacity iused     ifree %iused  Mounted on
/dev/disk2  457Gi  1.9Gi  455Gi     1%      71 953981891    0%   /Volumes/zfs500gb
retina:~ mirandaa$ ls -alh /Volumes/zfs500gb/file 
-rw-r--r--  1 mirandaa  staff   977M 22 Feb 13:32 /Volumes/zfs500gb/file
retina:~ mirandaa$ 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The system, is transparent, just just get more used space, and less free space:&lt;/p&gt;

&lt;p&gt;&lt;figure&gt;&lt;a href='/images/kikitux.net 2013-02-22 at 1.42.08 PM.png' &gt;&lt;img src='https://raw.github.com/kikitux/kikitux.github.com/master/images/kikitux.net 2013-02-22 at 1.42.08 PM.png'  max-width='99%' /&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/p&gt;

&lt;p&gt;&lt;figure&gt;&lt;a href='/images/kikitux.net 2013-02-22 at 1.41.49 PM.png' &gt;&lt;img src='https://raw.github.com/kikitux/kikitux.github.com/master/images/kikitux.net 2013-02-22 at 1.41.49 PM.png'  max-width='99%' /&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/p&gt;

&lt;p&gt;This is an excerpt from an oracle post &lt;a href=&quot;https://blogs.oracle.com/relling/entry/zfs_copies_and_data_protection&quot;&gt;https://blogs.oracle.com/relling/entry/zfs_copies_and_data_protection&lt;/a&gt;&lt;/p&gt;

&lt;h3&gt;Using Copies&lt;/h3&gt;

&lt;p&gt;To change the numbers of data copies, set the copies property. For example, suppose I have a zpool named &quot;zwimming.&quot; The default number of data copies is 1. But you can change that to 2 quite easily.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# zfs set copies=2 zwimming
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The copies property works for all new writes, so I recommend that you set that policy when you create the file system or immediately after you create a zpool.&lt;/p&gt;

&lt;p&gt;You can verify the copies setting by looking at the properties.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# zfs get copies zwimming
NAME      PROPERTY  VALUE     SOURCE
zwimming  copies    2         local
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ZFS will account for the space used. For example, suppose I create three new file systems and copy some data to them. You can then see that the space used reflects the number of copies. If you use quotas, then the copies will be charged against the quotas, too.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# zfs create -o copies=1 zwimming/single
# zfs create -o copies=2 zwimming/dual
# zfs create -o copies=3 zwimming/triple
# cp -rp /usr/share/man1 /zwimming/single
# cp -rp /usr/share/man1 /zwimming/dual
# cp -rp /usr/share/man1 /zwimming/triple
# zfs list -r zwimming                                                       
NAME              USED  AVAIL  REFER  MOUNTPOINT
zwimming         48.2M   310M  33.5K  /zwimming
zwimming/dual    16.0M   310M  16.0M  /zwimming/dual
zwimming/single  8.09M   310M  8.09M  /zwimming/single
zwimming/triple  23.8M   310M  23.8M  /zwimming/triple
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This makes sense. Each file system has one, two, or three copies of the data and will use correspondingly one, two, or three times as much space to store the data.&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>SQL Staments</title>
   <link href="http://kikitux.net/sql/sql-staments.html"/>
   <updated>2013-02-21T00:00:00+13:00</updated>
   <id>http://kikitux.net/sql/sql-staments</id>
   <content type="html">&lt;h3&gt;Data manipulation language (DML)&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;SELECT
INSERT
UPDATE
DELETE
MERGE
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Data definition language (DDL)&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;CREATE
ALTER
DROP
RENAME
TRUNCATE
COMMENT
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Data control language (DCL)&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;GRANT
REVOKE
&lt;/code&gt;&lt;/pre&gt;

&lt;h3&gt;Transaction control&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;COMMIT
ROLLBACK
SAVEPOINT
&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>HR Schema</title>
   <link href="http://kikitux.net/oracle/hr-schema.html"/>
   <updated>2013-02-21T00:00:00+13:00</updated>
   <id>http://kikitux.net/oracle/hr-schema</id>
   <content type="html">&lt;h1&gt;HR Schema in Oracle sample database&lt;/h1&gt;

&lt;p&gt;&lt;figure&gt;&lt;a href='https://raw.github.com/kikitux/kikitux.github.com/master/images/oracle/hr.png' &gt;&lt;img src='https://raw.github.com/kikitux/kikitux.github.com/master/images/oracle/hr.png'  max-width='99%' /&gt;&lt;/a&gt;&lt;/figure&gt;&lt;/p&gt;

&lt;p&gt;Alvaro&lt;/p&gt;
</content>
 </entry>
 
 <entry>
   <title>New Post1</title>
   <link href="http://kikitux.net/new-post1.html"/>
   <updated>2013-02-20T00:00:00+13:00</updated>
   <id>http://kikitux.net/new-post1</id>
   <content type="html">&lt;p&gt;layout: post
title: &quot;new post1&quot;
description: &quot;&quot;
category: test&lt;/p&gt;

&lt;h2&gt;tags: []&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;figure&amp;gt;&amp;lt;a href=https://raw.github.com/kikitux/kikitux.github.com/master/images/2013/02/meminfo_05.png&amp;gt;&amp;lt;img src=https://raw.github.com/kikitux/kikitux.github.com/master/images/2013/02/meminfo_05.png max-width='99%' /&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/figure&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
</content>
 </entry>
 
 <entry>
   <title>OSX server and ruby dependencies</title>
   <link href="http://kikitux.net/osx/osx-server-and-ruby-dependencies.html"/>
   <updated>2013-02-14T00:00:00+13:00</updated>
   <id>http://kikitux.net/osx/osx-server-and-ruby-dependencies</id>
   <content type="html">&lt;p&gt;I am a person who likes to have backups, and be on the bleeding edge most of the time, testing, checking.. learnings.. even when that mean break my database box at the office and also found that yesterdy update of ruby at my mac mini server &lt;a href=&quot;http://support.apple.com/kb/TS4042&quot;&gt;broke the ruby dependencies&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I was wondering how long it will take break my mac server anyways.. took, 2 days.. :D&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://raw.github.com/kikitux/kikitux.github.com/master/images/osx/Server.png&quot; title=&quot;Osx Server&quot; alt=&quot;OSX Server&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Alvaro&lt;/p&gt;
</content>
 </entry>
 
 
</feed>